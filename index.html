<script
    src="https://static.meteoblue.com/cdn/mapbox-gl-js/v1.11.1/mapbox-gl.js"
    integrity="sha512-v5PfWsWi47/AZBVL7WMNqdbM1OMggp9Ce408yX/X9wg87Kjzb1xqpO2Ul0Oue8Vl9kKOcwPM2MWWkTbUjRxZOg=="
    crossorigin="anonymous"
></script>

<link
    rel="stylesheet"
    href="https://static.meteoblue.com/cdn/mapbox-gl-js/v1.11.1/mapbox-gl.css"
    integrity="sha512-xY1TAM00L9X8Su9zNuJ8nBZsGQ8IklX703iq4gWnsw6xCg+McrHXEwbBkNaWFHSqmf6e7BpxD6aJQLKAcsGSdA=="
    crossorigin="anonymous"
>

<script src="https://static.meteoblue.com/lib/maps-plugin/v0.x/maps-plugin.js"></script>

<style>
    #mapContainer {
        height: 100%;
        width: 100%;
    }
    .custom-marker {
      background-image: url("https://www.svgrepo.com/show/489975/wind-turbine.svg");
      background-size: contain;
      background-repeat: no-repeat;
      width: 36px;
      height: 36px;
      cursor: pointer;
    }
</style>

<div id="mapContainer"></div>

<script>
    const mapboxMap = new mapboxgl.Map({
        container: "mapContainer",
        center: [7.57327 , 47.5584],
        zoom: 5,
        minZoom: 0,
        maxZoom: 24,
        hash: false,
        attributionControl: false,
        keyboard: false,
        maxBounds: [ [-71.522001,-28.908091], [-71.431335,-28.850945] ],
    });

    const apiKey = "CoNOYmRQEU5Xnsr7";
    const inventoryUrl = "https://maps-api.meteoblue.com/v1/map/inventory/filter?lang=es&apikey=CoNOYmRQEU5Xnsr7&maps=windAnimation,radar,cloudsAndPrecipitation,temperature,wind,gust,humidity,precipitationProbability&temperatureUnit=CELSIUS&velocityUnit=METER_PER_SECOND&lengthUnit=metric&overlays=pressure2mOverlay,graticuleOverlay";

    new meteoblueMapsPlugin({
        mapboxMap: mapboxMap,
        inventory: inventoryUrl,
        apiKey: apiKey,
        canUseRestricted: true,
    });
//WIND TURBINES
const turbineCoordinates =[ 
    [256176,6801744], [256437,6801578], [256702,6801408], [256967,6801250], [257227,6801095], [257490,6800946],
    [257769,6800821],[258117,6800804],  [258402,6800723], [258686,6800646], [258967,6800561], [259253,6800483],[259544,6800425],
    [259848,6800475],[260140,6800536],[260425,6800618],[260718,6800676],[261015,6800686],[261314,6800672],[261622,6800671],[256656,6803337],
    [256955,6803260], [257244,6803192], [257534,6803124], [257834,6803083], [258178,6803024], [258474,6803001], [258758,6802908], [259032,6802803],
    [259281,6802641], [259519,6802460], [259729,6802253], [259943,6802046], [260160,6801838], [257143,6804447], [257439,6804488], [257723,6804392],[258002,6804296],
    [258323,6804211], [258622,6804163], [258888,6804095], [259174,6804006], [259660,6803816], [259905,6803643], [260150,6803473], [260375,6803271], [260584,6803059],
    [260795,6802856], [261006,6802644], [261215,6802435], [261423,6802228], [261631,6802023], [261840,6801817], [262049,6801610], [262280,6801429], [262463,6801242]
    ];
    
    // Add a marker for each turbine
    turbineCoordinates.forEach((coord, index) => {
      const el = document.createElement("div");
      el.className = "custom-marker";
      
      new mapboxgl.Marker(el)
        .setLngLat(coord)
        .setPopup(new mapboxgl.Popup().setText(`WTG ${index + 1}`))
        .addTo(mapboxMap);
    });
</script>
